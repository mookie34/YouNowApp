<div class="p-6 bg-gray-50 min-h-screen">
  <!-- üîπ Encabezado -->
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-3xl font-bold text-gray-800 flex items-center gap-2">
      üõí Productos registrados
    </h1>

    <!-- Bot√≥n nuevo producto -->
    <button
      class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow-md transition-all duration-200"
      (click)="openForm()"
    >
      Nuevo Producto
    </button>
  </div>

  <!-- üîπ Mensajes -->
  <div *ngIf="successMessage" class="mb-4 p-3 rounded-md bg-green-100 text-green-800 shadow-sm">
    ‚úÖ {{ successMessage }}
  </div>

  <div *ngIf="loading" class="text-gray-500 italic">Cargando productos...</div>
  <div *ngIf="error" class="text-red-600 font-medium">{{ error }}</div>

  <!-- üîπ Barra de b√∫squeda -->
  <div class="bg-white p-4 rounded-lg shadow-sm mb-6 flex flex-col md:flex-row md:flex-wrap gap-3 items-center">
    <!-- Tipo de b√∫squeda -->
    <select
      [(ngModel)]="searchType"
      class="border border-gray-300 px-3 py-2 rounded-lg focus:ring-2 focus:ring-blue-400 outline-none w-full md:w-auto"
    >
      <option value="id">Buscar por ID</option>
      <option value="name">Buscar por nombre</option>
    </select>

    <!-- Campo de b√∫squeda (reactivo) -->
    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="onSearchChange($event.target.value)"
      placeholder="Ingrese t√©rmino de b√∫squeda"
      class="border border-gray-300 px-3 py-2 rounded-lg flex-grow focus:ring-2 focus:ring-blue-400 outline-none w-full md:flex-1"
    />

    <!-- Bot√≥n para mostrar filtros avanzados -->
    <button
      (click)="showFilters = !showFilters"
      class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-4 py-2 rounded-lg transition-all duration-200 w-full md:w-auto"
    >
      {{ showFilters ? 'Ocultar filtros avanzados ‚¨ÜÔ∏è' : 'Filtros avanzados ‚¨áÔ∏è' }}
    </button>

    <!-- Bot√≥n limpiar -->
    <button
      (click)="clearInputSearch()"
      class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-all duration-200 w-full md:w-auto"
    >
      Limpiar
    </button>
  </div>

  <!-- üß© Filtros avanzados -->
  <div *ngIf="showFilters" class="bg-gray-50 p-4 rounded-lg shadow-inner mb-6 flex flex-wrap gap-3">
    <!-- Precio m√≠nimo -->
    <div class="flex flex-col">
      <label class="text-sm font-semibold text-gray-600 mb-1">Precio m√≠nimo</label>
      <input
        type="number"
        [(ngModel)]="minPrice"
        (input)="searchProduct()"
        placeholder="Ej: 1000"
        class="border border-gray-300 px-3 py-2 rounded-lg w-36 focus:ring-2 focus:ring-blue-400 outline-none"
      />
    </div>

    <!-- Precio m√°ximo -->
    <div class="flex flex-col">
      <label class="text-sm font-semibold text-gray-600 mb-1">Precio m√°ximo</label>
      <input
        type="number"
        [(ngModel)]="maxPrice"
        (input)="searchProduct()"
        placeholder="Ej: 5000"
        class="border border-gray-300 px-3 py-2 rounded-lg w-36 focus:ring-2 focus:ring-blue-400 outline-none"
      />
    </div>

    <!-- Estado activo/inactivo -->
    <div class="flex flex-col">
      <label class="text-sm font-semibold text-gray-600 mb-1">Estado</label>
      <select
        [(ngModel)]="isActive"
        (change)="searchProduct()"
        class="border border-gray-300 px-3 py-2 rounded-lg w-36 focus:ring-2 focus:ring-blue-400 outline-none"
      >
        <option value="">Todos</option>
        <option value="true">Activos</option>
        <option value="false">Inactivos</option>
      </select>
    </div>
  </div>

  <!-- üîπ Tabla de productos -->
  <div *ngIf="!loading && !error" class="overflow-x-auto bg-white rounded-xl shadow-lg">
    <table class="min-w-full border-collapse">
      <thead class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white">
        <tr>
          <th class="py-3 px-4 text-center font-bold">ID</th>
          <th class="py-3 px-4 text-center font-bold">Nombre</th>
          <th class="py-3 px-4 text-center font-bold">Descripci√≥n</th>
          <th class="py-3 px-4 text-center font-bold">Precio</th>
          <th class="py-3 px-4 text-center font-bold">Activo</th>
          <th class="py-3 px-4 text-center font-bold">Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr
          *ngFor="let product of products"
          class="border-b hover:bg-blue-100 hover:shadow-md hover:scale-[1.01] transition-all duration-200 cursor-pointer">
          <td class="py-2 px-4 text-center">{{ product.id }}</td>
          <td class="py-2 px-4 text-center">{{ product.name }}</td>
          <td class="py-2 px-4 text-center">{{ product.description }}</td>
          <td class="py-2 px-4 text-center">
            ${{ product.price | number: '1.2-2':'es-CO' }}
          </td>
          <td class="py-2 px-4 text-center">
            <input type="checkbox" [checked]="product.is_active" disabled />
          </td>
          <td class="py-3 px-4 text-center flex justify-center gap-2">
            <button
              (click)="editProduct(product)"
              class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-md transition-all"
            >
              ‚úèÔ∏è Editar
            </button>
            <button
              (click)="deactivateProduct(product.id)"
              class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-1 rounded-md transition-all mr-2"
            >
              üö´ Desactivar
            </button>
            <button
              (click)="deleteProduct(product.id)"
              class="bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-md transition-all"
            >
              üóëÔ∏è Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- üîπ Modal formulario producto -->
  <div
    *ngIf="showForm"
    class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"
  >
    <div class="bg-white w-96 rounded-2xl shadow-2xl overflow-hidden animate-fadeIn">
      <div class="bg-gradient-to-r from-blue-600 to-indigo-600 p-4">
        <h2 class="text-xl font-bold text-white text-center">
          {{ editingProduct ? 'Editar Producto' : 'Nuevo Producto' }}
        </h2>
      </div>

      <div class="p-6">
        <form (ngSubmit)="saveProduct()" class="space-y-4">
          <div>
            <label class="block text-gray-700 font-medium mb-1">Nombre</label>
            <input
              type="text"
              [(ngModel)]="productForm.name"
              name="name"
              required
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none transition-all duration-150"
            />
          </div>

          <div>
            <label class="block text-gray-700 font-medium mb-1">Descripci√≥n</label>
            <input
              type="text"
              [(ngModel)]="productForm.description"
              name="description"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none transition-all duration-150"
            />
          </div>

          <div>
            <label class="block text-gray-700 font-medium mb-1">Precio</label>
            <input
              type="text"
              [(ngModel)]="productForm.price"
              name="price"
              appPriceFormat
              required
              placeholder="Ej: 12.000"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none transition-all duration-150"
            />
          </div>

          <div>
            <label class="block text-gray-700 font-medium mb-1">Activo</label>
            <input
              type="checkbox"
              [(ngModel)]="productForm.is_active"
              name="is_active"
              class="w-5 h-5 cursor-pointer accent-blue-500"
              [checked]="true"
            />
          </div>

          <div class="flex justify-end gap-3 pt-2">
            <button
              type="button"
              (click)="closeForm()"
              class="px-4 py-2 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition-all duration-150"
            >
              Cancelar
            </button>
            <button
              type="submit"
              class="px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold shadow-md hover:from-blue-700 hover:to-indigo-700 transition-all duration-150"
            >
              Guardar
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
