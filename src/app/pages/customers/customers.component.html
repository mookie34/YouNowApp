<div class="p-6">
  <h1 class="text-2xl font-bold mb-4">Clientes registrados</h1>
  <div *ngIf="successMessage" class="mb-4 p-2 bg-green-200 text-green-800 rounded">
    {{ successMessage }}
  </div>
  <!-- Estado: cargando -->
  <div *ngIf="loading" class="text-gray-500">Cargando clientes...</div>

  <!-- Estado: error -->
  <div *ngIf="error" class="text-red-600">{{ error }}</div>
  <!--Botón para crear nuevo cliente-->
  <button class="bg-blue-500 text-white px-4 py-2 rounded mb-4 hover:bg-blue-600" (click)="openForm()">
    Nuevo Cliente
  </button>
  <!-- Busqueda de cliente-->
   <div class="flex gap-2 mb-4 items-center">
    <select [(ngModel)]="searchType" class="border px-2 py-1 rounded">
      <option value="id">Buscar por ID</option>
      <option value="phone">Buscar por Teléfono</option>
    </select>

    <input
      type="text"
      [(ngModel)]="searchTerm"
      (input)="onSearchChange($event.target.value)"
      placeholder="Ingrese término de búsqueda"
      class="border px-2 py-1 rounded flex-grow"
    />


    <button (click)="clearInputSearch()" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">
      Limpiar
    </button>

   </div>
  <!-- Tabla de clientes -->
  <div *ngIf="!loading && !error">
    <table class="min-w-full bg-white border border-blue-200 rounded-lg shadow">
      <thead class="bg-blue-100 text-gray-700">
        <tr>
          <th class="py-2 px-4 text-center">ID</th>
          <th class="py-2 px-4 text-center">Nombre</th>
          <th class="py-2 px-4 text-center">Teléfono</th>
          <th class="py-2 px-4 text-center">Email</th>
          <th class="py-2 px-4 text-center">Fecha creación</th>
          <th class="py-2 px-4 text-center">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let customer of customers" class="border-t hover:bg-blue-50">
          <td class="py-2 px-4 text-center">{{ customer.id }}</td>
          <td class="py-2 px-4 text-center">{{ customer.name }}</td>
          <td class="py-2 px-4 text-center">{{ customer.phone }}</td>
          <td class="py-2 px-4 text-center">{{ customer.email || '—' }}</td>
          <td class="py-2 px-4 text-center">
            {{ customer.created_at ? (customer.created_at | date:'short') : '—' }}
          </td>
          <td class="py-2 px-4 text-center">
            <button
              (click)="editCustomer(customer)"
              class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600">
              Editar
            </button>
             <button
              (click)="deleteCustomer(customer.id)"
              class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 ml-3">
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal formulario para crear nuevo cliente -->
   <div *ngIf="showForm" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg shadow-lg w-96">
      <h2 class="text-xl font-bold mb-4">
        {{editingCustomer ? 'Editar Cliente' : 'Nuevo Cliente' }}
      </h2>
      <form (ngSubmit)="saveCustomer()">
        <div class="mb-2">
          <label class="block mb-1">Nombre</label>
          <input type="text" [(ngModel)]="customerForm.name" name="name" required class="w-full border px-2 py-1 rounded">
        </div>
        <div class="mb-2">
          <label class="block mb-1">Teléfono</label>
          <input type="text" [(ngModel)]="customerForm.phone" name="phone" required class="w-full border px-2 py-1 rounded">
        </div>
        <div class="mb-2">
          <label class="block mb-1">Email</label>
          <input type="email" [(ngModel)]="customerForm.email" name="email" required class="w-full border px-2 py-1 rounded">
        </div>

        <div class="flex justify-end">
          <button type="button" (click)="closeForm()" class="mr-2 px-4 py-2 rounded border">Cancelar</button>
          <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Guardar</button>
        </div>
      </form>


    </div>



   </div>
</div>

